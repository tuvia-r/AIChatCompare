<div
  class="column gap-4 p-2 justify-content-between text-color-secondary h-full"
>
  <p-accordion [multiple]="true" [(activeIndex)]="activeIndexes">
    <p-accordionTab header="Chats" styleClass="p-0">
      <p-menu
        [model]="(allChats$ | async) ?? []"
        class="w-full h-full"
        styleClass="border-none w-full h-full pl-4"
      >
        <ng-template pTemplate="item" let-item>
          <div class="row justify-content-between align-items-center w-full menu-item" [class.active-item]="(activeChatId$ | async) === item.id">
            <div
              class="column justify-content-center flex-grow-1 p-2"
              pRipple
              (click)="selectChat(item.id)"
            >
              <span class="font-bold">{{ item.label }}</span>
            </div>
            <p-button
              pRipple
              class="p-button-rounded p-button-text"
              icon="pi pi-times"
              styleClass="shadow-none text-300 hover:text-red-700"
              [text]="true"
              (click)="
                $event.preventDefault();
                $event.stopPropagation();
                deleteChat(item.id)
              "
            ></p-button>
          </div>
        </ng-template>
      </p-menu>
    </p-accordionTab>

    <p-accordionTab header="Chat Settings">
      <div class="column gap-4 pl-3">
        <div
          *ngFor="let apiService of allChatApis"
          class="row justify-content-between align-items-center"
          [class.opacity-60]="apiService.isAvailable() !== true"
          [pTooltip]="
            apiService.isAvailable() !== true
              ? 'Add API key to enable this API'
              : ''"
        >
          <span class="font-bold" >{{ apiService.modelName }}</span>
          <p-inputSwitch
            [disabled]="apiService.isAvailable() !== true"
            [(ngModel)]="apiService.enabled"
            pTooltip="Enable/Disable this API, Important: make sure not to share private data. for more details visit openAi/google"
          ></p-inputSwitch>
        </div>
        <div class="row justify-content-between align-items-center">
          <span class="font-bold">Temp</span>
          <p-slider
            class="w-6"
            [min]="0.1"
            [max]="1"
            [step]="0.01"
            [(ngModel)]="paramService.temperature"
          ></p-slider>
          <span class="font-bold">{{ paramService.temperature }}</span>
        </div>
      </div>
    </p-accordionTab>

    <p-accordionTab header="API Keys" pTooltip="Secrets will be stored on you device (localStorage), and will not be shared with any one">
      <div class="column gap-4 pl-3">
        <div class="row justify-content-between align-items-center gap-1 md:gap-4 overflow-x-auto">
          <span class="p-float-label w-8">
            <input
              pInputText
              type="password"
              [id]="'openAiKey' + id"
              class="w-full"
              [formControl]="openAiApiForm"
            />
            <label [for]="'openAiKey' + id" class="font-bold">OpenAI</label>
          </span>
          <p-button
            [disabled]="openAiApiForm.pristine || openAiApiForm.invalid"
            pRipple
            class="p-button-rounded p-button-text"
            icon="pi pi-save"
            [text]="true"
            [icon]="hasOpenAiApiKey() ? 'pi pi-check' : 'pi pi-save'"
            [severity]="hasOpenAiApiKey() ? 'success' : 'primary'"
            (click)="onOpenAiApiFormSubmit()"
          ></p-button>
        </div>
        <div class="row justify-content-between align-items-center">
          <span class="p-float-label w-8">
            <input
              pInputText
              type="password"
              [id]="'googleAiKey' + id"
              class="w-full"
              [formControl]="googleApiForm"
            />
            <label [for]="'googleAiKey' + id" class="font-bold">Google</label>
          </span>
          <p-button
            [disabled]="googleApiForm.pristine || googleApiForm.invalid"
            pRipple
            class="p-button-rounded p-button-text"
            [icon]="hasGoogleApiKey() ? 'pi pi-check' : 'pi pi-save'"
            [severity]="hasGoogleApiKey() ? 'success' : 'primary'"
            [text]="true"
            (click)="onGoogleApiFormSubmit()"
          ></p-button>
        </div>
      </div>
    </p-accordionTab>
  </p-accordion>
  <ai-chat-share-btns></ai-chat-share-btns>
</div>
